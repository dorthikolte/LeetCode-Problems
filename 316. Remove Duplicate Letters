import java.util.*;

class Solution {
    public String removeDuplicateLetters(String s) {
        
        int n = s.length();
        
        // Step 1: last occurrence of each character
        int[] last = new int[26];
        for (int i = 0; i < n; i++) {
            last[s.charAt(i) - 'a'] = i;
        }
        
        // Step 2: stack and visited array
        Stack<Character> stack = new Stack<>();
        boolean[] visited = new boolean[26];
        
        // Step 3: iterate through string
        for (int i = 0; i < n; i++) {
            char c = s.charAt(i);
            int idx = c - 'a';
            
            // If already used, skip
            if (visited[idx]) continue;
            
            // Step 4: pop larger characters if they appear later
            while (!stack.isEmpty() &&
                   stack.peek() > c &&
                   last[stack.peek() - 'a'] > i) {
                
                char removed = stack.pop();
                visited[removed - 'a'] = false;
            }
            
            // Step 5: push current char
            stack.push(c);
            visited[idx] = true;
        }
        
        // Step 6: build result
        StringBuilder sb = new StringBuilder();
        for (char c : stack) {
            sb.append(c);
        }
        
        return sb.toString();
    }
}
