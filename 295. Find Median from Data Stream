import java.util.PriorityQueue;

class MedianFinder {

    // Max heap for lower half
    private PriorityQueue<Integer> lower;
    // Min heap for upper half
    private PriorityQueue<Integer> higher;

    public MedianFinder() {
        lower = new PriorityQueue<>((a, b) -> b - a); // max heap
        higher = new PriorityQueue<>();              // min heap
    }
    
    public void addNum(int num) {
        // Step 1: add to max heap
        lower.offer(num);

        // Step 2: balance ordering
        higher.offer(lower.poll());

        // Step 3: balance sizes
        if (higher.size() > lower.size()) {
            lower.offer(higher.poll());
        }
    }
    
    public double findMedian() {
        if (lower.size() > higher.size()) {
            return lower.peek();
        }
        return (lower.peek() + higher.peek()) / 2.0;
    }
}
